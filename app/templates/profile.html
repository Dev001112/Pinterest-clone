{% extends "base.html" %}

{% block title %}Profile â€“ PinBoard{% endblock %}

{% block body %}
<div class="dashboard-wrapper">

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <div class="sidebar-logo">PinBoard</div>
      <!-- Clickable avatar -> profile -->
      <a href="{{ url_for('profile') }}" class="text-decoration-none">
        <div class="rounded-circle bg-dark text-white d-flex align-items-center justify-content-center"
             style="width:32px;height:32px;font-size:0.8rem;">
          {{ current_user.username[0] | upper if current_user.is_authenticated else 'U' }}
        </div>
      </a>
    </div>

    <ul class="sidebar-nav">
      <li>
        <a href="{{ url_for('dashboard', tab='home') }}" class="sidebar-link">
          <span class="icon">ğŸ </span>
          <span>Home</span>
        </a>
      </li>
      <li>
        <a href="{{ url_for('dashboard', tab='upload') }}" class="sidebar-link">
          <span class="icon">â¬†ï¸</span>
          <span>Upload</span>
        </a>
      </li>
      <li>
        <a href="{{ url_for('dashboard', tab='messages') }}" class="sidebar-link">
          <span class="icon">ğŸ’¬</span>
          <span>Messages</span>
        </a>
      </li>
      <li>
        <a href="{{ url_for('dashboard', tab='settings') }}" class="sidebar-link">
          <span class="icon">âš™ï¸</span>
          <span>Settings</span>
        </a>
      </li>
      <li>
        <a href="{{ url_for('profile') }}" class="sidebar-link active">
          <span class="icon">ğŸ‘¤</span>
          <span>Profile</span>
        </a>
      </li>
    </ul>

    <hr>

    <div class="mt-3 small text-muted">
      <div>Logged in as <strong>{{ current_user.username }}</strong></div>
      <a href="{{ url_for('logout') }}" class="text-muted">Logout</a>
    </div>
  </aside>

  <!-- Main content -->
  <main class="main-content">
    <header class="topbar">
      <div class="topbar-title">
        Profile
      </div>
      <div class="d-flex align-items-center gap-2">
        <span class="text-muted small">
          {{ current_user.email }}
        </span>
      </div>
    </header>

    <div class="row g-4">

      <!-- Liked Pins -->
      <div class="col-12">
        <div class="custom-card mb-2">
          <h5 class="mb-1">Liked Pins</h5>
          <p class="text-muted mb-0">
            All the pins youâ€™ve liked across PinBoard.
          </p>
        </div>

        {% if liked_pins %}
          <div class="pin-grid">
            {% for pin in liked_pins %}
            <div class="pin-card">
              <img src="{{ url_for('static', filename='uploads/' ~ pin.image_filename) }}"
                   class="pin-card-img" alt="{{ pin.title }}">
              <div class="pin-card-body">
                <div class="fw-semibold text-truncate">{{ pin.title }}</div>
                {% if pin.description %}
                  <small class="text-muted d-block text-truncate">{{ pin.description }}</small>
                {% endif %}
                <small class="text-muted d-block">
                  by {{ pin.author.username }} Â· {{ pin.created_at.strftime('%Y-%m-%d') }}
                </small>
              </div>
            </div>
            {% endfor %}
          </div>
        {% else %}
          <p class="text-muted">You havenâ€™t liked any pins yet.</p>
        {% endif %}
      </div>

      <!-- Saved Pins -->
      <div class="col-12 mt-3">
        <div class="custom-card mb-2">
          <h5 class="mb-1">Saved Pins</h5>
          <p class="text-muted mb-0">
            Pins youâ€™ve saved to check later.
          </p>
        </div>

        {% if saved_pins %}
          <div class="pin-grid">
            {% for pin in saved_pins %}
            <div class="pin-card">
              <img src="{{ url_for('static', filename='uploads/' ~ pin.image_filename) }}"
                   class="pin-card-img" alt="{{ pin.title }}">
              <div class="pin-card-body">
                <div class="fw-semibold text-truncate">{{ pin.title }}</div>
                {% if pin.description %}
                  <small class="text-muted d-block text-truncate">{{ pin.description }}</small>
                {% endif %}
                <small class="text-muted d-block">
                  by {{ pin.author.username }} Â· {{ pin.created_at.strftime('%Y-%m-%d') }}
                </small>
              </div>
            </div>
            {% endfor %}
          </div>
        {% else %}
          <p class="text-muted">You havenâ€™t saved any pins yet.</p>
        {% endif %}
      </div>

    </div>

  </main>
</div>
{% endblock %}
